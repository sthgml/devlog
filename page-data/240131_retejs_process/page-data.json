{"componentChunkName":"component---src-templates-post-template-tsx","path":"/240131_retejs_process/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>문제 상황1: Error: uncaught cancelled error</h2>\n<ol>\n<li>문제점:\n<ol>\n<li>uncaught cancelled error가 수십만번 발생</li>\n<li>cancelled란?\n<ol>\n<li>rete 의 dataflow engine이 fetch중에 reset 되었을 때</li>\n</ol>\n</li>\n</ol>\n</li>\n</ol>\n<ul>\n<li>\n<p>원인:</p>\n<ul>\n<li>\n<p>process 함수: node의 connection이 변경될때마다 실행됨</p>\n<ul>\n<li>reset 함수: 노드 실행이 반복적으로 수행되는 것을 피하기 위해 노드의 결과값들이 캐시되므로 이 캐시를 지워주는 과정이 필요한 것임</li>\n<li>fetch 함수: fetch는 타겟 노드 (a-b 연결되어있으면 b노드)에서부터 모든 자손 노드들을 그래프 순회하며 노드의 data() 를 실행시킴</li>\n<li>data 함수: input 노드로부터 인자를 받아옴 output을 return 함 다음에 연결될 노드의 input 인자로 전달됨</li>\n</ul>\n</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">process</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  engine<span class=\"token punctuation\">.</span><span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  editor\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getNodes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> engine<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>해결 방안: </p>\n<ul>\n<li>addPipe 실행 시점 변경\n<ul>\n<li>As-is: 페이지가 렌더링 완료된 시점</li>\n<li>To-be: 페이지 렌더링 + 모든 노드 생성 완료</li>\n</ul>\n</li>\n<li>addPipe: \n<ul>\n<li>connection의 생성과 삭제를 감지하여 process()함수를 trigger</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>결과: 최초 로딩 속도를 1.6초에서 1.0초로 감소 시킴</p>\n</li>\n</ul>\n<h2>문제 상황2: 노드 생성 시 중복 생성됨</h2>\n<h3>트리 형태 데이터로 부터 노드를 생성</h3>\n<p>vience-mlops 의 노드 간 데이터 교환은 연결된 모든 노드의 정보가 input이라는 객체 안에 재귀적으로 전달되도록 설계되어 있는데요. 이를 통해서 노드를 생성합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/123e5f6eddea7563803d8965029461ba/b4bc2/vience-mlops-node-connection.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABy0lEQVR42q2TXU8TQRhG+YtemPhBBEGjtr9Cg5S22y2SGDV4YdQY9cIQ9ELFfm67LUtBtIHWVQliu6h0dlvcTUzYepxWVExTAsZJnptJ3pN53pMZsG2fcnGLV/kGr/X+Wda2WKt+xfOg/NFBX5czm9uIDYGzbOKYdVotnwGr7hE7nyI8mCMypBE51ZvocI6xoylmb5i0fYinFjj3XN6VKtRSRewJBXH7Pi3xTQItj3gwTXRIRxnJo5zuTWxUZ/x4lsfTb/El8Eq6RGAuz3gHmDawo3HE3Yf/CziPHfknYIYnEsh3mEovEnihE1qsYmWMv4GbEqgGU3JXuX2BIfnCmetVXNdHTcwTeKYxZqywntBpRFTEnQd7gIEkYbn8/sB8F/jo6ipCeChzBS48zXKpWOa9BH8Jx2j8Ah648jFZ+aasLM9UZrfykqyc/SOleVgps9MmOzsHkDIZzKAMF7qDsZHeqGcKhE5ovy13pAR3pXSByuQeYN0lejYhK2mETmblYG8mBjUuHkkyc+0N7TaoSYPRzg6llFqyiLgcRty697Oy4/hUX9pUFhwqpf5ZMWw23nm48uuZ1jZLNZvVTy621aJZ+UBz7bP8em1+AGMC7CTPd/QnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/123e5f6eddea7563803d8965029461ba/a59e9/vience-mlops-node-connection.webp 192w,\n/static/123e5f6eddea7563803d8965029461ba/0ca9f/vience-mlops-node-connection.webp 384w,\n/static/123e5f6eddea7563803d8965029461ba/dc9b9/vience-mlops-node-connection.webp 768w,\n/static/123e5f6eddea7563803d8965029461ba/e2c2f/vience-mlops-node-connection.webp 1152w,\n/static/123e5f6eddea7563803d8965029461ba/0528b/vience-mlops-node-connection.webp 1310w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/123e5f6eddea7563803d8965029461ba/3b721/vience-mlops-node-connection.png 192w,\n/static/123e5f6eddea7563803d8965029461ba/66595/vience-mlops-node-connection.png 384w,\n/static/123e5f6eddea7563803d8965029461ba/fe486/vience-mlops-node-connection.png 768w,\n/static/123e5f6eddea7563803d8965029461ba/d2d74/vience-mlops-node-connection.png 1152w,\n/static/123e5f6eddea7563803d8965029461ba/b4bc2/vience-mlops-node-connection.png 1310w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/123e5f6eddea7563803d8965029461ba/fe486/vience-mlops-node-connection.png\"\n            alt=\"node-connections\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>예를 들어서 위의 이미지와 같이 연결된 세 개의 노드가 있을 때,</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"datasetPath\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 모든 노드가 공유</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"nodes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"input\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token comment\">// 세 번째 노드</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"input\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 두 번째 노드</span>\n          <span class=\"token punctuation\">{</span> \n            <span class=\"token property\">\"input\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 첫 번째 노드</span>\n              <span class=\"token string\">\"dff4b305254cce94\"</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token property\">\"dataset\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"nodeId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"be7b3f5e3a788272\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 두 번째 노드</span>\n          <span class=\"token property\">\"convolution2d\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"nodeId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"be7b3f5e3a788272\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Conv2d\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"kernelSize\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 세 번째 노드</span>\n    <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"trainer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"nodeId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"8cafcac1529da5c9\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Trainer\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와 같이 연결된 노드의 이름을 키, 옵션 값이 저장된 객체가 값인 “node”라는 객체가 “input”이라는 키의 값으로 배열로 저장되어 전달됩니다. 다음 노드로 전달할 때도 마찬가지로 input에 “nodes”를 넣어 전달합니다.</p>\n<h3>문제점1: 중복되는 노드가 있는 경우</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8b6062a469b5fef46a0aab8b7f70184a/c19a6/mlops-node-overlap.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42nWQ227DIBBE/f8/WFW9SXYAGxZ2AeNL2mS6dqK+9eEILYg5A501DaMrYN4RphX91DD4iikuyorAV6T8A36S6x1Sbv/SDV8Fpk8aVjGaGe+G8dZ7mJFhNPh1SPi4kM5ZZQU+bX8COZjvD+qDLoQN3jfEuINogw0NVi9O1M6Gn1YwOIaPM5yevfROgwlJVlyogFyGqCzLjqyyLtcb8tNwPCdrbVbOFscq17NVSDuifIN0DmkFse7pN9GooTZB0gKJC34BPA0wLGG/804AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8b6062a469b5fef46a0aab8b7f70184a/a59e9/mlops-node-overlap.webp 192w,\n/static/8b6062a469b5fef46a0aab8b7f70184a/0ca9f/mlops-node-overlap.webp 384w,\n/static/8b6062a469b5fef46a0aab8b7f70184a/dc9b9/mlops-node-overlap.webp 768w,\n/static/8b6062a469b5fef46a0aab8b7f70184a/179a7/mlops-node-overlap.webp 959w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8b6062a469b5fef46a0aab8b7f70184a/3b721/mlops-node-overlap.png 192w,\n/static/8b6062a469b5fef46a0aab8b7f70184a/66595/mlops-node-overlap.png 384w,\n/static/8b6062a469b5fef46a0aab8b7f70184a/fe486/mlops-node-overlap.png 768w,\n/static/8b6062a469b5fef46a0aab8b7f70184a/c19a6/mlops-node-overlap.png 959w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8b6062a469b5fef46a0aab8b7f70184a/fe486/mlops-node-overlap.png\"\n            alt=\"overlap-node\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>문제는 <mark style=\"color:green;\"><code class=\"language-text\">input이 두 개인 노드(초록색 Cat 노드)</code></mark>가 등장하면서 발생합니다. 우측의 cat 노드에서 나온 두 개의 노드에서 각각 convolution 2D 노드부터 Dataset 노드가 나오는 모습이 보입니다. </p>\n<p>하지만 원래 의도한 모양은 아래의 모양이었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1cf6cf933d1a278e94d78def332a5792/1e0a0/vience-mlops-node-overlap.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.10416666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAsklEQVR42sWR3QqDMAxGff9X3IUwULHWpv+zzvotdrIhXg02VjjQhnCSNBW+fKqfCTVNGGWEMQmS71JHaJug3QwXMrMUPN99ee8xnxFvy1lILOn7iFEldCKiGxzjcblK1C2hFRbtEDDqGWQWKEbbDKUzrD8J11KR7MpJT4iTyWQ0wqNuqMjrTjMSgmIpIDmu1ARnJlasxw4Dt71V8q/RduJ73AP+DsvfssliSJ8sZf3vlh/qPnQxDusTcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1cf6cf933d1a278e94d78def332a5792/a59e9/vience-mlops-node-overlap.webp 192w,\n/static/1cf6cf933d1a278e94d78def332a5792/0ca9f/vience-mlops-node-overlap.webp 384w,\n/static/1cf6cf933d1a278e94d78def332a5792/dc9b9/vience-mlops-node-overlap.webp 768w,\n/static/1cf6cf933d1a278e94d78def332a5792/e2c2f/vience-mlops-node-overlap.webp 1152w,\n/static/1cf6cf933d1a278e94d78def332a5792/f3efb/vience-mlops-node-overlap.webp 1536w,\n/static/1cf6cf933d1a278e94d78def332a5792/f11a6/vience-mlops-node-overlap.webp 2486w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1cf6cf933d1a278e94d78def332a5792/3b721/vience-mlops-node-overlap.png 192w,\n/static/1cf6cf933d1a278e94d78def332a5792/66595/vience-mlops-node-overlap.png 384w,\n/static/1cf6cf933d1a278e94d78def332a5792/fe486/vience-mlops-node-overlap.png 768w,\n/static/1cf6cf933d1a278e94d78def332a5792/d2d74/vience-mlops-node-overlap.png 1152w,\n/static/1cf6cf933d1a278e94d78def332a5792/e8464/vience-mlops-node-overlap.png 1536w,\n/static/1cf6cf933d1a278e94d78def332a5792/1e0a0/vience-mlops-node-overlap.png 2486w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1cf6cf933d1a278e94d78def332a5792/fe486/vience-mlops-node-overlap.png\"\n            alt=\"no-overlap-node\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>두 개의 input으로 들어온 BatchNorm2D 노드와 MaxPool 2D 노드가 각각의 input 값으로 같은 노드를 저장하고 있었습니다. 하지만 코드는 그 사실을 알 수 없기 때문에, 또다른 노드와 또다른 커넥션을 생성했던 것이죠.</p>\n<p>이러한 문제는 노드의 개수가 많아지면서 심각성을 나타냈습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb2020d330519fa5461c183b1452fa12/b80b7/mlops-node-check.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.208333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVR42n2QzUoCYRSG3bUqCIK6gO6hq+oy2rSMNMpMzX6mcsZJLX8rKwgSJKkWLQyhKB11Gp3Rz5nm87x9/ixaRAce3sOB8/Ke41lepKlb3+Ns71UNGeldtRn0J1pBn2rIUqIVWD/VpbCihbdiRnAjDseJAvgXz8pSff65igU83DTp/AS9VIzsMwUsEwdLHIOlFNhpFd/5JEirAQMSDAAS+kd5hvUBzFn3xaa2torPgNet723zIZqyz2sRP68fhngtuMG7hTyH7XBiPQ7ucrHPaQImjAzFYMYtl3UjvAkt4CU9ug9dPUIjdoiGcoCGfICWIsFIn8KIRmBXXtDvWihd5GALxYCD9fswO51xQuE8Dc5bcGy4bYPMQhZG/hztqwza17mx0WUaX9kk9KQMXdoBq1ZgWSa4zUanvhfv8CRLvwyB5uQNg2/LJKfTJtfqkNu1yDVFb4pezIc49U/ijA2fSCLdSJ23MrHSCf0Ag2yUcnNMH7QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cb2020d330519fa5461c183b1452fa12/a59e9/mlops-node-check.webp 192w,\n/static/cb2020d330519fa5461c183b1452fa12/0ca9f/mlops-node-check.webp 384w,\n/static/cb2020d330519fa5461c183b1452fa12/dc9b9/mlops-node-check.webp 768w,\n/static/cb2020d330519fa5461c183b1452fa12/e2c2f/mlops-node-check.webp 1152w,\n/static/cb2020d330519fa5461c183b1452fa12/f3efb/mlops-node-check.webp 1536w,\n/static/cb2020d330519fa5461c183b1452fa12/39bea/mlops-node-check.webp 4175w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cb2020d330519fa5461c183b1452fa12/3b721/mlops-node-check.png 192w,\n/static/cb2020d330519fa5461c183b1452fa12/66595/mlops-node-check.png 384w,\n/static/cb2020d330519fa5461c183b1452fa12/fe486/mlops-node-check.png 768w,\n/static/cb2020d330519fa5461c183b1452fa12/d2d74/mlops-node-check.png 1152w,\n/static/cb2020d330519fa5461c183b1452fa12/e8464/mlops-node-check.png 1536w,\n/static/cb2020d330519fa5461c183b1452fa12/b80b7/mlops-node-check.png 4175w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cb2020d330519fa5461c183b1452fa12/fe486/mlops-node-check.png\"\n            alt=\"중복 확인 과정\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>위에서 두 개의 노드와 한 개의 커넥션이 불필요하게 생성되었다면 이렇게 노드가 많은 상황에서는 39개의 노드와 38개의 커넥션이 불필요하게 생성되니, connection이 생성되거나 제거될 때마다 실행되는 process 함수도 그만큼 많이 실행되면서 실행 속도를 늦추고 심지어는 사이트가 멈추는 문제까지 발생시켰습니다.</p>\n<p>따라서 해결해야 하는 문제는 두 가지 였습니다.</p>\n<ol>\n<li>중복되는 노드 생성 막기</li>\n<li>중복되는 커넥션 생성 막기</li>\n</ol>\n<p>해결은 간단했습니다. 백엔드 개발자 분에게 데이터 구조를 생성할 때 노드 ID를 16진법 16자리 string으로 추가해서 전달해달라고 요청하고, 생성된 노드 ID는 generatedNodesId라는 배열을 만들어 저장, 매 생성마다 배열을 확인하여 중복을 검사하는 과정을 추가하였습니다. 노드간 연결하는 커넥션도 같은 방식으로 중복을 검사하여 해결했습니다.</p>\n<h3>문제점2: 생성되는 데이터 구조 자체의 문제</h3>\n<p>중복을 제거하고 나서도 여전히 이상하게 렌더되는 노드들.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d931ebcbb0be80b14cae8710593c027/c3855/model_from_back.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABeUlEQVR42oVSTU/DMAzt7weNMyfOiOPEDoDgdyAhLoDWNkmTtF0/1i/z3Cbd1jFR6cmuEz8/2wlsRqsZllYyLG+ynK7y94+74mXzWLw9bcr1/fNu/fCaf37d2oKuT3IWCOjoG4CmG6hvOtrjp/boJ9sP9O8X2KxvPXTataEs2jjO20hVHSNWZbcVRR8CcVK3Qu9bkx5ylgDhQMdQuqEozAiJJOHHyX70Yz1ZgZhOe1rmeZwQGkcoxI62sgJZTdI0MxEXYF/b7jIh5JNJXYAtLqdI4riEOkZi2hHKgQkvkQYCKmIPViEKkqoiZadEpScSw4VyOnSDgnxuFu0H86GD0RVsRwkIfbs8R6/smMCTXpyhZUIoTXCJWzxO9uq0dTGcW1dgHAFEmKynsy0nsoCiyo1h2m4EX/A8QSJlSQrIvg1Zt3Eex0+cU6TKc8IUbWp+MnO7NUWipBCXI1WPVqBgAp/Vjl1AvQG5wZiCv9dPZ7HpNUztzvP+I+cXmsmStN7CrHsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3d931ebcbb0be80b14cae8710593c027/a59e9/model_from_back.webp 192w,\n/static/3d931ebcbb0be80b14cae8710593c027/0ca9f/model_from_back.webp 384w,\n/static/3d931ebcbb0be80b14cae8710593c027/dc9b9/model_from_back.webp 768w,\n/static/3d931ebcbb0be80b14cae8710593c027/e2c2f/model_from_back.webp 1152w,\n/static/3d931ebcbb0be80b14cae8710593c027/f3efb/model_from_back.webp 1536w,\n/static/3d931ebcbb0be80b14cae8710593c027/49fd7/model_from_back.webp 6006w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3d931ebcbb0be80b14cae8710593c027/3b721/model_from_back.png 192w,\n/static/3d931ebcbb0be80b14cae8710593c027/66595/model_from_back.png 384w,\n/static/3d931ebcbb0be80b14cae8710593c027/fe486/model_from_back.png 768w,\n/static/3d931ebcbb0be80b14cae8710593c027/d2d74/model_from_back.png 1152w,\n/static/3d931ebcbb0be80b14cae8710593c027/e8464/model_from_back.png 1536w,\n/static/3d931ebcbb0be80b14cae8710593c027/c3855/model_from_back.png 6006w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3d931ebcbb0be80b14cae8710593c027/fe486/model_from_back.png\"\n            alt=\"만들어지는 노드들\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e7a4a97c7d7732902bee8e203156d44e/aae64/createByDatastructure_014.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.770833333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVR42m2QW0/CQBCF+///gfFFjKKCIJfWFFpugWBUjCGSKA/KpeXS1kIttKQtneOyxIiJk3yZk83OmbMruP06Wfcl0sQs6eUiTRjTWonG4jVNVIl0OU8zRaTQ/SIAhO2WEMd7/Q+C/dDGR+II2k0SUzkHLX8FvVTEMJvEqJDGKHeJSSEFf/AOXus14DhAFOGwiIgjbGY6tNQJhqkEG77AMH0Krbg3GmXOMGYLtOw57Ls6yPdBpgkKArCkP05/jIXtxocuZTBgQ7oqcaZVGbNmFRNFBHs+Q4bRqsBg9+aKxJP0nh7Rf+kyw5ib28slLMuCsNsQ+x4/XPWeYdTLMBsKzFaVUYOx0wyjWcFcvYWWPIbTacNbr+C5LigMebJXVUY3f80MD2JHroPg00RoW5xoaSNcML3rywUiZ4HAmPH++3kxb95bA6tOFt+nP7LyTkO6LwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e7a4a97c7d7732902bee8e203156d44e/a59e9/createByDatastructure_014.webp 192w,\n/static/e7a4a97c7d7732902bee8e203156d44e/0ca9f/createByDatastructure_014.webp 384w,\n/static/e7a4a97c7d7732902bee8e203156d44e/dc9b9/createByDatastructure_014.webp 768w,\n/static/e7a4a97c7d7732902bee8e203156d44e/e2c2f/createByDatastructure_014.webp 1152w,\n/static/e7a4a97c7d7732902bee8e203156d44e/f3efb/createByDatastructure_014.webp 1536w,\n/static/e7a4a97c7d7732902bee8e203156d44e/182da/createByDatastructure_014.webp 3754w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e7a4a97c7d7732902bee8e203156d44e/3b721/createByDatastructure_014.png 192w,\n/static/e7a4a97c7d7732902bee8e203156d44e/66595/createByDatastructure_014.png 384w,\n/static/e7a4a97c7d7732902bee8e203156d44e/fe486/createByDatastructure_014.png 768w,\n/static/e7a4a97c7d7732902bee8e203156d44e/d2d74/createByDatastructure_014.png 1152w,\n/static/e7a4a97c7d7732902bee8e203156d44e/e8464/createByDatastructure_014.png 1536w,\n/static/e7a4a97c7d7732902bee8e203156d44e/aae64/createByDatastructure_014.png 3754w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e7a4a97c7d7732902bee8e203156d44e/fe486/createByDatastructure_014.png\"\n            alt=\"딥러닝 개발자가 의도한 노드들\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>원래 의도했던 노드의 배열과 연결을 모르니 일단 딥러닝 개발자 분이 만들어주신 노드와 완성된 모델의 모습을 그려달라 요청했습니다. 그리고 이를 렌더되는 노드와 비교해보았습니다. 그 결과, 전달되는 데이터에서는 18번째로 ConvTranspose 2D 노드가 전달되는데, PPT에 따르면 그 전에 cat 노드가 먼저 배치되었어야 했죠.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">BE에서 받은 데이터구조는 중간의 cat layer가 datset위치에 가있고, \ncat layer에 또 앞의 노드들이 input으로 담겨있음을 확인</code></pre></div>\n<p>과 같이 딥러닝 개발자 분께 전달하였고, 서버에서 데이터 구조를 생성하는 코드의 로직을 변경함으로써 완전히 문제를 해결할 수 있었습니다.</p>\n<h3>문제를 해결하면서 배운 점</h3>\n<p>처음에는 중복되는 노드들이 백엔드에서 데이터 구조를 잘못 주었기 때문이라고 생각해서 오류로 전달을 드렸습니다. 하지만 전달되는 데이터 구조에서의 노드 개수보다 생성되는 노드의 개수가 많다는 것을 알게 되고, 중복을 제거하는 과정을 추가적으로 수행해야 했습니다. 의도한 대로 결과가 나오지 않을 때 내 코드에 문제가 없는지 먼저, 꼼꼼히 살펴보는 습관을 가져야겠다는 다짐을 하게 되었던 트러블 슈팅이었습니다.</p>","frontmatter":{"title":"노드 생성 자동화와 데이터 구조 변경","summary":"중복 생성되는 노드를 제거하기 위해 BE, 딥러닝 개발자 분과 소통하여 데이터구조 변경하여 해결한 경험","date":"2024.01.31.","categories":["트러블슈팅","바이언스","학부생인턴","rete.js"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABy0lEQVR42q2TXU8TQRhG+YtemPhBBEGjtr9Cg5S22y2SGDV4YdQY9cIQ9ELFfm67LUtBtIHWVQliu6h0dlvcTUzYepxWVExTAsZJnptJ3pN53pMZsG2fcnGLV/kGr/X+Wda2WKt+xfOg/NFBX5czm9uIDYGzbOKYdVotnwGr7hE7nyI8mCMypBE51ZvocI6xoylmb5i0fYinFjj3XN6VKtRSRewJBXH7Pi3xTQItj3gwTXRIRxnJo5zuTWxUZ/x4lsfTb/El8Eq6RGAuz3gHmDawo3HE3Yf/CziPHfknYIYnEsh3mEovEnihE1qsYmWMv4GbEqgGU3JXuX2BIfnCmetVXNdHTcwTeKYxZqywntBpRFTEnQd7gIEkYbn8/sB8F/jo6ipCeChzBS48zXKpWOa9BH8Jx2j8Ah648jFZ+aasLM9UZrfykqyc/SOleVgps9MmOzsHkDIZzKAMF7qDsZHeqGcKhE5ovy13pAR3pXSByuQeYN0lejYhK2mETmblYG8mBjUuHkkyc+0N7TaoSYPRzg6llFqyiLgcRty697Oy4/hUX9pUFhwqpf5ZMWw23nm48uuZ1jZLNZvVTy621aJZ+UBz7bP8em1+AGMC7CTPd/QnAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/123e5f6eddea7563803d8965029461ba/8a4bf/vience-mlops-node-connection.png","srcSet":"/static/123e5f6eddea7563803d8965029461ba/d6dfb/vience-mlops-node-connection.png 328w,\n/static/123e5f6eddea7563803d8965029461ba/85cef/vience-mlops-node-connection.png 655w,\n/static/123e5f6eddea7563803d8965029461ba/8a4bf/vience-mlops-node-connection.png 1310w","sizes":"(min-width: 1310px) 1310px, 100vw"},"sources":[{"srcSet":"/static/123e5f6eddea7563803d8965029461ba/f78e2/vience-mlops-node-connection.webp 328w,\n/static/123e5f6eddea7563803d8965029461ba/1858e/vience-mlops-node-connection.webp 655w,\n/static/123e5f6eddea7563803d8965029461ba/bbe84/vience-mlops-node-connection.webp 1310w","type":"image/webp","sizes":"(min-width: 1310px) 1310px, 100vw"}]},"width":1310,"height":780}},"publicURL":"/static/123e5f6eddea7563803d8965029461ba/vience-mlops-node-connection.png"}}}}]}},"pageContext":{"slug":"/240131_retejs_process/"}},"staticQueryHashes":[],"slicesMap":{}}